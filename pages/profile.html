<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crazy Fitness</title>
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" />
    <!-- Notify -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/suryaumapathy2812/notify__js/notify.css">

    <style>
        body {
            background-color: black;
            color: aqua;
        }

        .container {
            margin-top: 5%;

        }

        h1 {
            margin-left: 43%;
        }

        #button {
            margin-top: 5%;
            margin-left: 40%;
            width: 20%;
            font-size: 100%;
        }

        #delete {
            margin-top: 5%;
            width: 20%;
            margin-left: 40%;
            font-size: 100%;
        }
    </style>
</head>

<body>
    <div class="container ">
        <br>
        <h1>Profile</h1>
        <br>
        <form id="form">
            <div class="row">
                <!-- first name -->
                <div class="col">
                    <label for="fname" class="form_label">First Name :</label>
                    <input type="text" id="fname" class="form-control" name="fname">
                </div>
                <!-- last name -->
                <div class="col">
                    <label for="lname" class="form_label">Last Name :</label>
                    <input type="text" id="lname" class="form-control" name="lname">
                </div>
            </div><br>
            <!-- email -->
            <div class="row">
                <div class="col">
                    <label for="email" class="form_label">Email :</label>
                    <input type="email" id="email" class="form-control" name="email" disabled>
                </div>
                <!-- password -->
                <div class="col">
                    <label for="Gender" class="form_label">Gender :</label>
                    <select id="gender" class="form-control">
                        <option value=""></option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="transgender">Transgender</option>
                    </select>
                </div>
            </div>
            <br>
            <!-- phone number -->
            <div class="row">
                <div class="col">
                    <label for="ph_number" class="form_label">Phone number :</label>
                    <input type="tel" id="ph_number" class="form-control" name="ph_number">
                </div>
                <!-- age -->
                <div class="col">
                    <label for="age" class="form_label">Age :</label>
                    <input type="number" id="age" class="form-control" name="age">
                </div>
            </div>
            <!-- address -->
            <br>
            <div class="row">
                <div class="col">
                    <label for="comment">Address :</label>
                    <textarea class="form-control" rows="8" id="comment" name="text"></textarea>
                </div>
                <!-- personal info -->
                <div class="col">
                    <label for="per_info">Personal info :</label>
                    <textarea class="form-control" rows="8" id="per_info" name="text"></textarea>
                </div>
            </div>
            <!-- submit -->
            <div class=" row  ">
                <div class="col"> <button id="button" type="submit" class="btn btn-success ">Change</button></div>
                <div class="col"><button id="delete" type="delete" class="btn btn-danger ">Delete</button></div>

            </div>
        </form>


    </div>
    <!-- Java Script -->
    <script src="https://cdn.jsdelivr.net/gh/suryaumapathy2812/notify__js/notify.js"></script>
    <script>
        // for email
        let current_email = JSON.parse(localStorage.getItem("details"))
        //  for array
        let user_about = JSON.parse(localStorage.getItem("usersdetails"))

        let user_obj = user_about.find(function (user) {
            let check_email = user["user_email"]
            if (current_email === check_email) {
                return true;
            }
        })
        // console.log(user_obj);


        let firname = document.getElementById("fname");
        let lastname = document.getElementById("lname");
        let age = document.getElementById("age");
        let mail = document.getElementById("email");
        let ph_num = document.getElementById("ph_number");


        firname.value = user_obj["user_name"];
        lastname.value = user_obj["user_lastname"];
        age.value = user_obj["user_age"];
        mail.value = current_email;
        ph_num.value = user_obj["user_ph_num"];




        let pro_info = document.getElementById("form");
        pro_info.addEventListener("submit", function (event) {
            event.preventDefault();

            let user_name = document.getElementById("fname").value;
            let user_lastname = document.getElementById("lname").value;
            let user_age = document.getElementById("age").value;
            let user_email = document.getElementById("email").value;
            let user_gender = document.getElementById("gender").value;
            let user_ph_num = document.getElementById("ph_number").value;
            let user_address = document.getElementById("comment").value;
            let per_info = document.getElementById("per_info").value;

            let user_object = {
                user_name,
                user_lastname,
                user_age,
                user_email,
                user_gender,
                user_ph_num,
                user_address,
                per_info,
            };
            let checked_obj = Object.assign(user_obj, user_object)
            // console.log(checked_obj);

            let index = user_about.indexOf(user_obj);
            // console.log(index);

            user_about[index] = checked_obj;

            localStorage.setItem("usersdetails", JSON.stringify(user_about));
            // console.log(user_about);

            Notify.success("Successfully Changed")

            // location.reload()
        })
        let check = true;
        let present_details = user_about.find(function (user) {
            let check_email = user["user_email"]
            if (current_email === check_email) {

                let firname2 = document.getElementById("fname");
                let lastname2 = document.getElementById("lname");
                let age2 = document.getElementById("age");
                let gender2 = document.getElementById("gender");
                let mail2 = document.getElementById("email");
                let ph_num2 = document.getElementById("ph_number");
                let address2 = document.getElementById("comment");
                let per_info2 = document.getElementById("per_info");

                firname2.value = user["user_name"];
                lastname2.value = user["user_lastname"];
                age2.value = user["user_age"];
                gender2.value = user["user_gender"];
                mail2.value = current_email;
                ph_num2.value = user["user_ph_num"];
                address2.value = user["user_address"];
                per_info2.value = user["per_info"];
            }
        })

        // For delete
        let user_delete = document.getElementById("delete");
        user_delete.addEventListener("click", function (event) {
            event.preventDefault()

            let Index = user_about.indexOf(user_obj)

            let msg = confirm("Are you sure want to delete your account")
            if (msg !== true) {
                return
            }
            else {
                user_about.splice(Index, 1)
                // console.log(user_about);
                localStorage.setItem("usersdetails", JSON.stringify(user_about))
                // location.reload()
                window.location.href = "../pages/sign_in.html";
            }
        })








    </script>

</body>

</html>